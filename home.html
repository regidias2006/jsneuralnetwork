<html>
    <head>
        <title>MultiLayer Perceptron</title>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.1/jquery.min.js" integrity="sha512-aVKKRRi/Q/YV+4mjoKBsE4x3H+BkegoM/em46NNlCqNTmUYADjBbeNefNxYV7giUp0VxICtqdrbqU7iVaeZNXA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <script src="assets/RegisNeuralNetWork.js"></script>
    </head>
    
    <body>
        <textarea id="json" style="width: 700px; height: 500px;"></textarea>

        <script>
            var training_sets = [
            { input: [23, 0, 1, 1.05, 2, 12.09, 49, 1.2, 2, 8.8, 22, 1, 1, 2.33, 5, 1.09, 3, 10.19, 49], output: [1] },
            { input: [18, 0, 10, 1.06, 2, 15.72, 58, 1, 1, 24.5, 39, 0, 0, 9, 9, 1.1, 3, 9.69, 58], output: [0] },
            { input: [26, 0, 8, 1.04, 2, 11, 54, 1, 1, 7.5, 17, 1, 1, 8, 8, 1.1, 3, 9.84, 57], output: [0] },
            { input: [30, 0, 2, 1.15, 2, 10.04, 46, 1.2, 2, 7.33, 12, 1, 1, 4, 6, 1.13, 3, 9.44, 55], output: [1] },
            { input: [27, 0, 11, 1.13, 2, 10.96, 35, 1, 1, 11.75, 20, 0, 0, 9, 9, 1.08, 3, 9.53, 53], output: [1] },
            { input: [24, 0, 8, 1.09, 2, 12.04, 75, 1, 1, 11.75, 30, 1, 1, 8, 8, 1.13, 4, 9.76, 75], output: [1] },
            { input: [30, 0, 12, 1.15, 2, 10.04, 30, 1, 1, 11.75, 19, 0, 0, 9, 9, 1.13, 3, 10.84, 60], output: [0] },
            { input: [21, 0, 11, 1.05, 2, 13.33, 43, 1, 1, 7.5, 20, 0, 0, 9, 9, 1.06, 3, 11.2, 67], output: [1] },
            { input: [26, 0, 19, 1.08, 2, 11, 57, 1, 1, 11.75, 21, 0, 0, 9, 9, 1.05, 3, 11.53, 88], output: [1] },
            { input: [33, 0, 5, 1.1, 2, 8.65, 38, 1.17, 2, 6.14, 13, 1, 1, 3.5, 5, 1.12, 3, 9.82, 60], output: [0] },
            { input: [26, 0, 3, 1.18, 2, 12.5, 57, 1, 1, 7.5, 20, 1, 1, 2.33, 3, 1.11, 3, 9.25, 57], output: [0] },
            { input: [27, 0, 12, 1.13, 2, 10.96, 40, 1.33, 2, 11.5, 12, 0, 0, 9, 9, 1.09, 3, 10.2, 49], output: [1] },
            { input: [37, 0, 6, 1.09, 2, 7.54, 29, 1.2, 2, 7.33, 16, 1, 1, 3.5, 6, 1.12, 3, 8.57, 41], output: [0] },
            { input: [29, 0, 5, 1.07, 2, 10.04, 41, 1, 1, 15.67, 41, 1, 1, 4.5, 5, 1.12, 2, 9.91, 61], output: [1] }
            ];

            var layerSizes = [19, 35, 35, 28, 28, 28, 28, 12, 12, 1];
            var aFuncs = [  
                ActivationFunction.None, 
                ActivationFunction.RationalSigmoid, 
                ActivationFunction.RationalSigmoid, 
                ActivationFunction.RationalSigmoid, 
                ActivationFunction.RationalSigmoid, 
                ActivationFunction.RationalSigmoid, 
                ActivationFunction.RationalSigmoid, 
                ActivationFunction.Sigmoid, 
                ActivationFunction.Sigmoid, 
                ActivationFunction.Linear
            ];

            var bpn = new MultiLayerPerceptron();

             bpn.Init(layerSizes, aFuncs);
             bpn.Train(training_sets, 100000);
             bpn.ToJson("json");

            console.log(Math.round(bpn.Run([35, 0, 4, 1.09, 2, 8.06, 39, 1, 1, 9, 23, 1, 1, 2.33, 4, 1.09, 3, 10.4, 64])))
        </script>
    </body>
</html>