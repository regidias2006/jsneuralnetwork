<html>
    <head>
        <title>MultiLayer Perceptron</title>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.1/jquery.min.js" integrity="sha512-aVKKRRi/Q/YV+4mjoKBsE4x3H+BkegoM/em46NNlCqNTmUYADjBbeNefNxYV7giUp0VxICtqdrbqU7iVaeZNXA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <script src="assets/RegisNeuralNetWork.js"></script>
    </head>
    
    <body>
        <textarea id="json" style="width: 700px; height: 500px;"></textarea>

        <script>
            var training_sets = [
            { input: [246, 0, 10, 1.05, 2, 13.95, 35, 1, 1, 9.4, 28, 1, 1, 10, 10, 0, 0, 4, 4, 1.09, 3, 10.09, 75], output: [0] },
            { input: [261, 0, 7, 1.09, 2, 12, 75, 1, 1, 12, 32, 1, 1, 5, 7, 0, 0, 4, 4, 1.13, 4, 9.76, 75], output: [0] },
            { input: [234, 0, 4, 1.19, 3, 9.96, 34, 1.2, 2, 7.5, 16, 1.5, 2, 2.67, 4, 0, 0, 4, 4, 1.11, 3, 10.76, 51], output: [1] },
            { input: [243, 0, 4, 1.03, 2, 8.09, 24, 1, 1, 7.67, 18, 1, 1, 5, 6, 0, 0, 4, 4, 1.09, 3, 10.19, 69], output: [1] },
            { input: [252, 0, 6, 1.09, 2, 12, 37, 1, 1, 12, 26, 1, 1, 5, 6, 0, 0, 4, 4, 1.13, 4, 10.11, 58], output: [0] },
            { input: [238, 0, 11, 1.15, 2, 10, 30, 1, 1, 12, 19, 0, 0, 11, 11, 0, 0, 4, 4, 1.13, 3, 10.84, 60], output: [0] },
            { input: [273, 1, 0, 1.11, 2, 7.46, 37, 1, 1, 9.2, 15, 1, 1, 10, 10, 1, 1, 3, 3, 1.11, 2, 9.08, 52], output: [1] },
            { input: [270, 0, 3, 1.32, 4, 7.29, 29, 1.13, 2, 4.67, 11, 1, 1, 3, 4, 1, 1, 3, 3, 1.16, 4, 9.68, 60], output: [1] },
            { input: [239, 0, 2, 1.06, 2, 15.67, 58, 1, 1, 6.43, 11, 1, 1, 5, 8, 1, 1, 1.5, 2, 1.1, 3, 10.49, 58], output: [0] },
            { input: [224, 0, 3, 1.08, 2, 10.5, 27, 1.17, 2, 6.29, 16, 1.5, 2, 2.67, 4, 1, 1, 3, 3, 1.07, 2, 10.91, 50], output: [1] },
            { input: [288, 1, 0, 1.1, 2, 8.9, 42, 1.17, 2, 7.33, 16, 1, 1, 10, 10, 1, 1, 3, 3, 1.11, 3, 8.61, 54], output: [0] },
            { input: [261, 0, 18, 1.17, 3, 10.88, 33, 1, 1, 9.4, 18, 0, 0, 11, 11, 0, 0, 4, 4, 1.17, 3, 10.06, 60], output: [1] },
            { input: [246, 0, 3, 1.07, 2, 9.64, 36, 1, 1, 6.43, 11, 1, 1, 5, 7, 1, 1, 3, 3, 1.09, 3, 10.09, 62], output: [0] },
            { input: [262, 0, 22, 1.13, 3, 8, 34, 1, 1, 9.4, 22, 0, 0, 11, 11, 0, 0, 4, 4, 1.11, 3, 9.51, 49], output: [0] },
            { input: [235, 1, 0, 1.19, 3, 9.93, 34, 1.17, 2, 7.17, 14, 1.33, 2, 3, 4, 1, 1, 2, 2, 1.11, 3, 10.76, 51], output: [1] },
            { input: [256, 0, 11, 1.13, 2, 10.92, 35, 1, 1, 11.75, 20, 0, 0, 10, 10, 0, 0, 3, 3, 1.08, 3, 9.53, 53], output: [1] },
            { input: [263, 0, 7, 1.2, 4, 10.38, 43, 1.25, 2, 9, 15, 1, 1, 4.5, 7, 0, 0, 3, 3, 1.11, 4, 9.54, 43], output: [0] },
            { input: [238, 0, 12, 1.15, 2, 10, 30, 1, 1, 11.75, 19, 0, 0, 10, 10, 0, 0, 3, 3, 1.13, 3, 10.84, 60], output: [0] },
            { input: [217, 0, 11, 1.05, 2, 13.29, 43, 1, 1, 7.5, 20, 0, 0, 10, 10, 0, 0, 3, 3, 1.06, 3, 11.2, 67], output: [1] },
            { input: [208, 0, 19, 1.08, 2, 10.96, 57, 1, 1, 11.75, 21, 0, 0, 10, 10, 0, 0, 3, 3, 1.05, 3, 11.53, 88], output: [1] },
            { input: [258, 0, 5, 1.1, 2, 8.61, 38, 1.17, 2, 6.14, 13, 1, 1, 2.67, 5, 0, 0, 3, 3, 1.12, 3, 9.82, 60], output: [0] },
            { input: [266, 0, 29, 1.13, 3, 8.58, 29, 1, 1, 16, 29, 0, 0, 10, 10, 0, 0, 3, 3, 1.09, 3, 9.22, 39], output: [0] },
            { input: [241, 0, 12, 1.13, 2, 11.38, 40, 1.33, 2, 11.5, 12, 0, 0, 10, 10, 0, 0, 3, 3, 1.09, 3, 10.2, 49], output: [1] },
            { input: [240, 0, 2, 1.07, 2, 8.65, 43, 1, 1, 9.2, 14, 1, 1, 4.5, 7, 1, 1, 2, 2, 1.15, 3, 10.89, 80], output: [0] },
            { input: [261, 0, 8, 1.09, 2, 12, 75, 1, 1, 11.75, 30, 1, 1, 4.5, 8, 0, 0, 3, 3, 1.13, 4, 9.76, 75], output: [1] },
            { input: [254, 0, 8, 1.04, 2, 11, 54, 1, 1, 7.5, 17, 1, 1, 4.5, 8, 0, 0, 3, 3, 1.1, 3, 9.84, 57], output: [0] },
            { input: [290, 0, 6, 1.09, 2, 7.51, 29, 1.2, 2, 7.33, 16, 1, 1, 2.67, 6, 0, 0, 3, 3, 1.12, 3, 8.57, 41], output: [0] },
            { input: [256, 0, 5, 1.07, 2, 10.04, 41, 1, 1, 15.67, 41, 1, 1, 4.5, 5, 0, 0, 3, 3, 1.12, 2, 9.91, 61], output: [1] },
            { input: [265, 0, 12, 1.09, 2, 7.28, 24, 1, 1, 9.2, 24, 0, 0, 10, 10, 0, 0, 3, 3, 1.07, 3, 9.12, 61], output: [0] },
            { input: [266, 0, 7, 1.14, 2, 9.24, 35, 1, 1, 5.38, 10, 1, 1, 4.5, 7, 0, 0, 3, 3, 1.11, 3, 9.38, 64], output: [0] },
            { input: [263, 0, 8, 1.2, 4, 10.8, 43, 1.25, 2, 9, 14, 1, 1, 4.5, 8, 0, 0, 3, 3, 1.11, 4, 9.54, 43], output: [1] },
            { input: [253, 0, 12, 1.1, 3, 8.93, 22, 1.4, 3, 8.6, 14, 0, 0, 10, 10, 0, 0, 3, 3, 1.15, 3, 10.29, 47], output: [0] },
            { input: [240, 0, 10, 1.04, 2, 9.71, 34, 1, 1, 7.5, 12, 0, 0, 10, 10, 0, 0, 3, 3, 1.11, 3, 10.53, 82], output: [0] },
            { input: [257, 0, 11, 1.06, 2, 15.67, 58, 1, 1, 24.5, 38, 0, 0, 10, 10, 0, 0, 3, 3, 1.1, 3, 9.69, 58], output: [1] },
            { input: [258, 0, 6, 1.1, 2, 8.61, 38, 1.17, 2, 6.14, 13, 1, 1, 4, 6, 0, 0, 3, 3, 1.12, 3, 9.82, 60], output: [0] },
            { input: [221, 0, 11, 1.05, 2, 12.64, 65, 1, 1, 11.75, 31, 0, 0, 10, 10, 0, 0, 3, 3, 1.13, 2, 11.7, 65], output: [0] },
            { input: [264, 0, 4, 1.08, 3, 7.25, 35, 1, 1, 4.1, 15, 1, 1, 2.67, 4, 0, 0, 3, 3, 1.12, 3, 9.54, 77], output: [1] },
            { input: [266, 0, 30, 1.13, 3, 8.87, 30, 1, 1, 16, 30, 0, 0, 10, 10, 0, 0, 3, 3, 1.09, 3, 9.22, 39], output: [0] },
            { input: [262, 0, 1, 1.16, 3, 10.42, 33, 1, 1, 7.5, 18, 1, 1, 4.5, 8, 1, 1, 1, 1, 1.17, 3, 10.06, 60], output: [1] },
            { input: [239, 0, 4, 1.06, 2, 15.67, 58, 1, 1, 6.29, 11, 1, 1, 4.5, 5, 0, 0, 3, 3, 1.1, 3, 10.49, 58], output: [1] },
            { input: [264, 0, 5, 1.07, 2, 8.65, 25, 1.17, 2, 6.14, 25, 1, 1, 4, 5, 0, 0, 3, 3, 1.13, 4, 9.67, 59], output: [0] },
            { input: [233, 1, 0, 1.15, 3, 9.96, 34, 1, 1, 9, 20, 1, 1, 4, 6, 1, 1, 2, 2, 1.11, 3, 10.76, 51], output: [1] }, 
            { input: [223, 2, 0, 1.08, 2, 11.42, 32, 1.2, 2, 8.8, 16, 2, 2, 8, 8, 2, 2, 2, 2, 1.07, 2, 10.91, 50], output: [0] },
            { input: [287, 0, 6, 1.1, 2, 8.93, 42, 1.2, 2, 7.33, 16, 2, 2, 4, 6, 0, 0, 4, 4, 1.11, 3, 8.61, 54], output: [0] },
            { input: [208, 0, 13, 1.08, 2, 10.5, 57, 1, 1, 11.75, 27, 0, 0, 10, 10, 0, 0, 4, 4, 1.05, 3, 11.53, 88], output: [0] },
            { input: [266, 1, 0, 1.14, 2, 9.21, 35, 1, 1, 5.25, 10, 1, 1, 4, 7, 1, 1, 3, 3, 1.11, 3, 9.38, 64], output: [0] },
            { input: [257, 0, 2, 1.1, 2, 8.9, 38, 1.33, 2, 6, 13, 1.5, 2, 3.5, 5, 1, 1, 1.5, 2, 1.12, 3, 9.82, 60], output: [1] }, 
            { input: [242, 0, 16, 1.03, 2, 8.38, 24, 1, 1, 9.2, 18, 0, 0, 10, 10, 0, 0, 4, 4, 1.09, 3, 10.19, 69], output: [1] }, 
            { input: [238, 1, 0, 1.1, 2, 8.58, 39, 1, 1, 9, 23, 1, 1, 8, 8, 1, 1, 3, 3, 1.09, 3, 10.4, 64], output: [0] },
            { input: [269, 0, 3, 1.33, 4, 7.53, 29, 1.14, 2, 5.25, 15, 1, 1, 2.67, 3, 1, 1, 3, 3, 1.16, 4, 9.68, 60], output: [0] },
            { input: [257, 0, 31, 1.13, 2, 11.38, 36, 1.25, 2, 9, 31, 0, 0, 10, 10, 0, 0, 4, 4, 1.11, 3, 9.69, 57], output: [1] }, 
            { input: [269, 1, 0, 1.18, 2, 12.45, 57, 1.2, 2, 8.8, 20, 1, 1, 9, 9, 1, 1, 3, 3, 1.11, 3, 9.25, 57], output: [0] },
            { input: [244, 0, 45, 1.31, 3, 16.41, 45, 2, 2, 24, 45, 0, 0, 10, 10, 0, 0, 4, 4, 1.1, 3, 10.28, 54], output: [0] },
            { input: [262, 0, 15, 1.09, 3, 7.28, 35, 1, 1, 4.56, 15, 0, 0, 10, 10, 0, 0, 4, 4, 1.12, 3, 9.54, 77], output: [1] }, 
            { input: [238, 0, 8, 1.17, 3, 8.83, 22, 1, 1, 11.75, 21, 1, 1, 4.5, 8, 0, 0, 4, 4, 1.11, 3, 10.59, 57], output: [1] }
            ];  

            // var layerSizes = [23, 80, 50, 50, 50, 50, 35, 35, 35, 22, 22, 22, 22, 1];
            // var aFuncs = [  
            //     ActivationFunction.None, 
            //     ActivationFunction.RationalSigmoid, 
            //     ActivationFunction.RationalSigmoid, 
            //     ActivationFunction.RationalSigmoid, 
            //     ActivationFunction.RationalSigmoid, 
            //     ActivationFunction.RationalSigmoid, 
            //     ActivationFunction.RationalSigmoid, 
            //     ActivationFunction.RationalSigmoid, 
            //     ActivationFunction.Sigmoid, 
            //     ActivationFunction.Sigmoid, 
            //     ActivationFunction.Sigmoid, 
            //     ActivationFunction.Sigmoid, 
            //     ActivationFunction.Sigmoid, 
            //     ActivationFunction.Linear
            // ];

            var layerSizes = [23, 60, 23, 10, 10, 1];
            var aFuncs = [  
                ActivationFunction.None, 
                ActivationFunction.RationalSigmoid, 
                ActivationFunction.RationalSigmoid, 
                ActivationFunction.Sigmoid, 
                ActivationFunction.Sigmoid, 
                ActivationFunction.Linear
            ];



            var bpn = new MultiLayerPerceptron();

             bpn.Init(layerSizes, aFuncs);
             bpn.Train(training_sets, 100000);
             bpn.ToJson("json");

            console.log(Math.round(bpn.Run([239, 0, 4, 1.06, 2, 15.67, 58, 1, 1, 6.29, 11, 1, 1, 4.5, 5, 0, 0, 3, 3, 1.1, 3, 10.49, 58])))
        </script>
    </body>
</html>