<html>
    <head>
        <title>MultiLayer Perceptron</title>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.1/jquery.min.js" integrity="sha512-aVKKRRi/Q/YV+4mjoKBsE4x3H+BkegoM/em46NNlCqNTmUYADjBbeNefNxYV7giUp0VxICtqdrbqU7iVaeZNXA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <script src="assets/RegisNeuralNetWork.js"></script>
    </head>
    
    <body>
        <textarea id="json" style="width: 700px; height: 500px;"></textarea>

        <script>
            var training_sets = [
            { input: [23, 0, 1, 1.05, 2, 12.09, 49, 1.2, 2, 8.8, 22, 1, 1, 2.33, 5, 1.09, 3, 10.19, 49], output: [1] },
            { input: [29, 0, 4, 1.07, 2, 9.71, 41, 1, 1, 11.75, 41, 1, 1, 4, 4, 1.12, 2, 9.91, 61], output: [0] },
            { input: [32, 1, 0, 1.19, 3, 9.96, 34, 1.17, 2, 7.17, 14, 1.5, 2, 3, 4, 1.11, 3, 10.76, 51], output: [0] },
            { input: [30, 0, 2, 1.15, 2, 10.04, 46, 1.2, 2, 7.33, 12, 1, 1, 4, 6, 1.13, 3, 9.44, 55], output: [1] },
            { input: [32, 0, 2, 1.03, 2, 8.41, 26, 1, 1, 5.38, 11, 1, 1, 2.33, 4, 1.13, 3, 9.1, 46], output: [0] },
            { input: [24, 0, 7, 1.09, 2, 12.04, 37, 1, 1, 11.75, 26, 1, 1, 4, 7, 1.13, 4, 10.11, 58], output: [0] },
            { input: [30, 0, 12, 1.15, 2, 10.04, 30, 1, 1, 11.75, 19, 0, 0, 9, 9, 1.13, 3, 10.84, 60], output: [0] },
            { input: [33, 0, 5, 1.1, 2, 8.65, 38, 1.17, 2, 6.14, 13, 1, 1, 3.5, 5, 1.12, 3, 9.82, 60], output: [0] },
            { input: [39, 0, 26, 1.11, 2, 7.28, 26, 1, 1, 9.2, 26, 0, 0, 9, 9, 1.12, 3, 10.8, 53], output: [0] },
            { input: [33, 0, 1, 1.1, 2, 8.65, 42, 1.17, 2, 6.14, 16, 1, 1, 4, 7, 1.11, 3, 8.61, 54], output: [0] },
            { input: [36, 0, 23, 1.13, 3, 8.03, 34, 1, 1, 9.2, 23, 0, 0, 9, 9, 1.11, 3, 9.51, 49], output: [0] },
            { input: [24, 0, 9, 1.04, 2, 11.54, 41, 1, 1, 7.5, 10, 0, 0, 9, 9, 1.09, 3, 10.14, 61], output: [0] },
            { input: [27, 0, 11, 1.13, 2, 10.96, 35, 1, 1, 11.75, 20, 0, 0, 9, 9, 1.08, 3, 9.53, 53], output: [1] },
            { input: [30, 0, 20, 1.15, 2, 10.04, 36, 1.25, 2, 9, 20, 0, 0, 9, 9, 1.08, 3, 10.4, 53], output: [0] },
            { input: [22, 0, 10, 1.05, 2, 12.68, 65, 1, 1, 11.75, 31, 0, 0, 9, 9, 1.13, 2, 11.7, 65], output: [0] },
            { input: [31, 0, 7, 1.19, 4, 10.38, 43, 1.25, 2, 9, 15, 1, 1, 4, 7, 1.11, 4, 9.54, 43], output: [0] },
            { input: [32, 0, 4, 1.07, 2, 8.68, 25, 1.17, 2, 6.14, 25, 1, 1, 3.5, 4, 1.13, 4, 9.67, 59], output: [0] },
            { input: [21, 0, 51, 1.31, 3, 16.47, 51, 0, 0, 50, 50, 0, 0, 9, 9, 1.1, 3, 10.28, 54], output: [0] },
            { input: [28, 0, 9, 1.04, 2, 9.75, 34, 1, 1, 7.5, 12, 0, 0, 9, 9, 1.11, 3, 10.53, 82], output: [0] },
            { input: [34, 1, 0, 1.03, 2, 8.09, 24, 1, 1, 7.33, 18, 1, 1, 3.5, 4, 1.09, 3, 10.19, 69], output: [0] },
            { input: [21, 0, 11, 1.05, 2, 13.33, 43, 1, 1, 7.5, 20, 0, 0, 9, 9, 1.06, 3, 11.2, 67], output: [1] },
            { input: [28, 1, 0, 1.08, 2, 10.5, 27, 1.17, 2, 7.17, 16, 1.33, 2, 1.67, 3, 1.07, 2, 10.91, 50], output: [0] },
            { input: [26, 0, 3, 1.18, 2, 12.5, 57, 1, 1, 7.5, 20, 1, 1, 2.33, 3, 1.11, 3, 9.25, 57], output: [0] },
            { input: [18, 0, 10, 1.06, 2, 15.72, 58, 1, 1, 24.5, 39, 0, 0, 9, 9, 1.1, 3, 9.69, 58], output: [0] },
            { input: [32, 0, 2, 1.07, 2, 8.68, 43, 1, 1, 9.2, 14, 1, 1, 4, 6, 1.15, 3, 10.89, 80], output: [0] },
            { input: [26, 0, 19, 1.08, 2, 11, 57, 1, 1, 11.75, 21, 0, 0, 9, 9, 1.05, 3, 11.53, 88], output: [1] },
            { input: [31, 0, 1, 1.07, 2, 9, 34, 1, 1, 11.75, 21, 1, 1, 4, 7, 1.1, 3, 9.35, 51], output: [0] },
            { input: [29, 0, 3, 1.04, 2, 9.38, 42, 1, 1, 16, 42, 1, 1, 4, 5, 1.07, 2, 9.16, 50], output: [0] },
            { input: [35, 0, 18, 1.13, 2, 8.31, 24, 1, 1, 11.75, 18, 0, 0, 9, 9, 1.11, 3, 9.59, 52], output: [0] },
            { input: [34, 0, 29, 1.13, 3, 8.61, 29, 1, 1, 16, 29, 0, 0, 9, 9, 1.09, 3, 9.22, 39], output: [0] },
            { input: [28, 0, 28, 1, 1, 9.41, 28, 1, 1, 9.2, 28, 0, 0, 9, 9, 1.11, 4, 10.7, 59], output: [0] },
            { input: [33, 0, 2, 1.14, 2, 9.24, 73, 1.17, 2, 6.14, 14, 1, 1, 4, 6, 1.13, 3, 9.72, 73], output: [0] },
            { input: [31, 0, 3, 1.07, 2, 9, 31, 1, 1, 6.29, 16, 1, 1, 4, 5, 1.14, 3, 9.47, 38], output: [0] },
            { input: [31, 0, 10, 1.19, 2, 10, 32, 1.2, 2, 7.33, 17, 0, 0, 9, 9, 1.09, 3, 9.19, 72], output: [0] },
            { input: [38, 0, 11, 1.09, 2, 7.31, 24, 1, 1, 9.2, 24, 0, 0, 9, 9, 1.07, 3, 9.12, 61], output: [0] },
            { input: [28, 0, 1, 1.12, 2, 10.5, 36, 1, 1, 7.5, 31, 1, 1, 2.33, 3, 1.11, 3, 9.69, 57], output: [0] },
            { input: [40, 2, 0, 1.14, 2, 7.46, 37, 1.2, 2, 8.8, 15, 2, 2, 7, 7, 1.11, 2, 9.08, 52], output: [0] },
            { input: [39, 0, 3, 1.08, 3, 7.08, 35, 1, 1, 4.1, 15, 1, 1, 2.33, 3, 1.12, 3, 9.54, 77], output: [0] },
            { input: [35, 0, 2, 1.03, 2, 7.6, 30, 1, 1, 5.38, 21, 1, 1, 2.33, 4, 1.08, 3, 10.2, 60], output: [0] },
            { input: [29, 0, 2, 1.04, 2, 9.38, 31, 1, 1, 7.33, 15, 1, 1, 4, 6, 1.08, 2, 10.1, 65], output: [0] },
            { input: [46, 1, 0, 1.31, 4, 7.29, 29, 1.11, 2, 4.44, 9, 1, 1, 3.5, 4, 1.16, 4, 9.68, 60], output: [0] },
            { input: [37, 0, 20, 1.12, 2, 7.76, 41, 1, 1, 9.2, 20, 0, 0, 9, 9, 1.11, 3, 9, 53], output: [0] },
            { input: [29, 1, 0, 1.16, 3, 10.88, 33, 1, 1, 9, 18, 1, 1, 8, 8, 1.17, 3, 10.06, 60], output: [0] },
            { input: [33, 0, 6, 1.14, 2, 8.93, 35, 1, 1, 5.25, 10, 1, 1, 4, 6, 1.11, 3, 9.38, 64], output: [0] },
            { input: [28, 0, 1, 1.12, 2, 10.5, 38, 1.17, 2, 7.17, 20, 1, 1, 4, 7, 1.12, 2, 10.37, 62], output: [0] },
            { input: [33, 0, 11, 1.1, 3, 8.65, 22, 1.4, 3, 7.17, 14, 0, 0, 9, 9, 1.15, 3, 10.29, 47], output: [0] },
            { input: [27, 0, 12, 1.13, 2, 10.96, 40, 1.33, 2, 11.5, 12, 0, 0, 9, 9, 1.09, 3, 10.2, 49], output: [1] },
            { input: [28, 0, 16, 1.04, 2, 9.75, 23, 1, 1, 9.2, 16, 0, 0, 9, 9, 1.06, 2, 10.47, 50], output: [0] },
            { input: [39, 0, 8, 1.11, 2, 7.28, 27, 1.5, 2, 8.8, 27, 1, 1, 8, 8, 1.13, 4, 9.72, 78], output: [0] },
            { input: [21, 0, 11, 1.05, 2, 14, 35, 1, 1, 9.2, 28, 0, 0, 9, 9, 1.09, 3, 10.09, 75], output: [0] },
            { input: [24, 0, 8, 1.09, 2, 12.04, 75, 1, 1, 11.75, 30, 1, 1, 8, 8, 1.13, 4, 9.76, 75], output: [1] },
            { input: [26, 0, 8, 1.04, 2, 11, 54, 1, 1, 7.5, 17, 1, 1, 8, 8, 1.1, 3, 9.84, 57], output: [0] },
            { input: [37, 0, 6, 1.09, 2, 7.54, 29, 1.2, 2, 7.33, 16, 1, 1, 3.5, 6, 1.12, 3, 8.57, 41], output: [0] },
            { input: [26, 0, 9, 1.18, 2, 11.96, 40, 1.25, 2, 9, 20, 0, 0, 9, 9, 1.09, 3, 9.26, 61], output: [0] },
            { input: [27, 0, 3, 1.04, 2, 10.15, 29, 1, 1, 7.5, 23, 1, 1, 4, 5, 1.09, 3, 11.61, 72], output: [0] },
            { input: [27, 0, 25, 1.08, 2, 10.54, 36, 1, 1, 7.5, 25, 0, 0, 9, 9, 1.1, 2, 9.7, 67], output: [0] },
            { input: [33, 0, 5, 1.1, 3, 8.65, 22, 1, 1, 9.2, 21, 1, 1, 4, 5, 1.11, 3, 10.59, 57], output: [0] },
            { input: [30, 0, 4, 1.07, 2, 9.68, 36, 1, 1, 7.33, 11, 1, 1, 4, 4, 1.09, 3, 10.09, 62], output: [0] },
            { input: [18, 0, 3, 1.06, 2, 15.72, 58, 1, 1, 6.29, 11, 1, 1, 4, 5, 1.1, 3, 10.49, 58], output: [0] },
            { input: [35, 0, 4, 1.09, 2, 8.06, 39, 1, 1, 9, 23, 1, 1, 2.33, 4, 1.09, 3, 10.4, 64], output: [0] }

            ];

            var layerSizes = [19, 19, 19, 19, 19, 19, 19, 19, 19, 1];
            var aFuncs = [  
                ActivationFunction.None, 
                ActivationFunction.RationalSigmoid, 
                ActivationFunction.RationalSigmoid, 
                ActivationFunction.RationalSigmoid, 
                ActivationFunction.RationalSigmoid, 
                ActivationFunction.RationalSigmoid, 
                ActivationFunction.RationalSigmoid, 
                ActivationFunction.Sigmoid, 
                ActivationFunction.Sigmoid, 
                ActivationFunction.Linear
            ];

            var bpn = new MultiLayerPerceptron();

             bpn.Init(layerSizes, aFuncs);
             bpn.Train(training_sets, 100000);
             bpn.ToJson("json");

            console.log(Math.round(bpn.Run([35, 0, 4, 1.09, 2, 8.06, 39, 1, 1, 9, 23, 1, 1, 2.33, 4, 1.09, 3, 10.4, 64])))
        </script>
    </body>
</html>